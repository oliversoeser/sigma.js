import{g as Re}from"./_commonjsHelpers-BosuxZz1.js";import{i as Ge}from"./utils-8yT8BWPw.js";import{g as je,d as ze}from"./defaults-9mJNxk8k.js";import{h as $e,d as Ve}from"./index-cx5rF6iY.js";var Ze=function(){var l,s,h={};(function(){var i=0,f=1,v=2,c=3,w=4,D=5,y=6,P=7,F=8,$=9,V=0,X=1,J=2,b=0,S=1,G=2,W=3,m=4,C=5,O=6,T=7,U=8,Y=3,H=10,se=3,d=9,we=10;h.exports=function(I,e,ae){var Ee,u,r,_,A,K,N,L,p,ke,Z=e.length,Ue=ae.length,le=I.adjustSizes,He=I.barnesHutTheta*I.barnesHutTheta,ue,R,E,k,q,g,o,n=[];for(r=0;r<Z;r+=H)e[r+w]=e[r+v],e[r+D]=e[r+c],e[r+v]=0,e[r+c]=0;if(I.outboundAttractionDistribution){for(ue=0,r=0;r<Z;r+=H)ue+=e[r+y];ue/=Z/H}if(I.barnesHutOptimize){var B=1/0,ee=-1/0,x=1/0,re=-1/0,z,ne,De;for(r=0;r<Z;r+=H)B=Math.min(B,e[r+i]),ee=Math.max(ee,e[r+i]),x=Math.min(x,e[r+f]),re=Math.max(re,e[r+f]);var fe=ee-B,ce=re-x;for(fe>ce?(x-=(fe-ce)/2,re=x+fe):(B-=(ce-fe)/2,ee=B+ce),n[0+b]=-1,n[0+S]=(B+ee)/2,n[0+G]=(x+re)/2,n[0+W]=Math.max(ee-B,re-x),n[0+m]=-1,n[0+C]=-1,n[0+O]=0,n[0+T]=0,n[0+U]=0,Ee=1,r=0;r<Z;r+=H)for(u=0,De=Y;;)if(n[u+C]>=0){e[r+i]<n[u+S]?e[r+f]<n[u+G]?z=n[u+C]:z=n[u+C]+d:e[r+f]<n[u+G]?z=n[u+C]+d*2:z=n[u+C]+d*3,n[u+T]=(n[u+T]*n[u+O]+e[r+i]*e[r+y])/(n[u+O]+e[r+y]),n[u+U]=(n[u+U]*n[u+O]+e[r+f]*e[r+y])/(n[u+O]+e[r+y]),n[u+O]+=e[r+y],u=z;continue}else if(n[u+b]<0){n[u+b]=r;break}else{if(n[u+C]=Ee*d,L=n[u+W]/2,p=n[u+C],n[p+b]=-1,n[p+S]=n[u+S]-L,n[p+G]=n[u+G]-L,n[p+W]=L,n[p+m]=p+d,n[p+C]=-1,n[p+O]=0,n[p+T]=0,n[p+U]=0,p+=d,n[p+b]=-1,n[p+S]=n[u+S]-L,n[p+G]=n[u+G]+L,n[p+W]=L,n[p+m]=p+d,n[p+C]=-1,n[p+O]=0,n[p+T]=0,n[p+U]=0,p+=d,n[p+b]=-1,n[p+S]=n[u+S]+L,n[p+G]=n[u+G]-L,n[p+W]=L,n[p+m]=p+d,n[p+C]=-1,n[p+O]=0,n[p+T]=0,n[p+U]=0,p+=d,n[p+b]=-1,n[p+S]=n[u+S]+L,n[p+G]=n[u+G]+L,n[p+W]=L,n[p+m]=n[u+m],n[p+C]=-1,n[p+O]=0,n[p+T]=0,n[p+U]=0,Ee+=4,e[n[u+b]+i]<n[u+S]?e[n[u+b]+f]<n[u+G]?z=n[u+C]:z=n[u+C]+d:e[n[u+b]+f]<n[u+G]?z=n[u+C]+d*2:z=n[u+C]+d*3,n[u+O]=e[n[u+b]+y],n[u+T]=e[n[u+b]+i],n[u+U]=e[n[u+b]+f],n[z+b]=n[u+b],n[u+b]=-1,e[r+i]<n[u+S]?e[r+f]<n[u+G]?ne=n[u+C]:ne=n[u+C]+d:e[r+f]<n[u+G]?ne=n[u+C]+d*2:ne=n[u+C]+d*3,z===ne)if(De--){u=z;continue}else{De=Y;break}n[ne+b]=r;break}}if(I.barnesHutOptimize)for(R=I.scalingRatio,r=0;r<Z;r+=H)for(u=0;;)if(n[u+C]>=0)if(g=Math.pow(e[r+i]-n[u+T],2)+Math.pow(e[r+f]-n[u+U],2),ke=n[u+W],4*ke*ke/g<He){if(E=e[r+i]-n[u+T],k=e[r+f]-n[u+U],le===!0?g>0?(o=R*e[r+y]*n[u+O]/g,e[r+v]+=E*o,e[r+c]+=k*o):g<0&&(o=-R*e[r+y]*n[u+O]/Math.sqrt(g),e[r+v]+=E*o,e[r+c]+=k*o):g>0&&(o=R*e[r+y]*n[u+O]/g,e[r+v]+=E*o,e[r+c]+=k*o),u=n[u+m],u<0)break;continue}else{u=n[u+C];continue}else{if(K=n[u+b],K>=0&&K!==r&&(E=e[r+i]-e[K+i],k=e[r+f]-e[K+f],g=E*E+k*k,le===!0?g>0?(o=R*e[r+y]*e[K+y]/g,e[r+v]+=E*o,e[r+c]+=k*o):g<0&&(o=-R*e[r+y]*e[K+y]/Math.sqrt(g),e[r+v]+=E*o,e[r+c]+=k*o):g>0&&(o=R*e[r+y]*e[K+y]/g,e[r+v]+=E*o,e[r+c]+=k*o)),u=n[u+m],u<0)break;continue}else for(R=I.scalingRatio,_=0;_<Z;_+=H)for(A=0;A<_;A+=H)E=e[_+i]-e[A+i],k=e[_+f]-e[A+f],le===!0?(g=Math.sqrt(E*E+k*k)-e[_+F]-e[A+F],g>0?(o=R*e[_+y]*e[A+y]/g/g,e[_+v]+=E*o,e[_+c]+=k*o,e[A+v]-=E*o,e[A+c]-=k*o):g<0&&(o=100*R*e[_+y]*e[A+y],e[_+v]+=E*o,e[_+c]+=k*o,e[A+v]-=E*o,e[A+c]-=k*o)):(g=Math.sqrt(E*E+k*k),g>0&&(o=R*e[_+y]*e[A+y]/g/g,e[_+v]+=E*o,e[_+c]+=k*o,e[A+v]-=E*o,e[A+c]-=k*o));for(p=I.gravity/I.scalingRatio,R=I.scalingRatio,r=0;r<Z;r+=H)o=0,E=e[r+i],k=e[r+f],g=Math.sqrt(Math.pow(E,2)+Math.pow(k,2)),I.strongGravityMode?g>0&&(o=R*e[r+y]*p):g>0&&(o=R*e[r+y]*p/g),e[r+v]-=E*o,e[r+c]-=k*o;for(R=1*(I.outboundAttractionDistribution?ue:1),N=0;N<Ue;N+=se)_=ae[N+V],A=ae[N+X],L=ae[N+J],q=Math.pow(L,I.edgeWeightInfluence),E=e[_+i]-e[A+i],k=e[_+f]-e[A+f],le===!0?(g=Math.sqrt(E*E+k*k)-e[_+F]-e[A+F],I.linLogMode?I.outboundAttractionDistribution?g>0&&(o=-R*q*Math.log(1+g)/g/e[_+y]):g>0&&(o=-R*q*Math.log(1+g)/g):I.outboundAttractionDistribution?g>0&&(o=-R*q/e[_+y]):g>0&&(o=-R*q)):(g=Math.sqrt(Math.pow(E,2)+Math.pow(k,2)),I.linLogMode?I.outboundAttractionDistribution?g>0&&(o=-R*q*Math.log(1+g)/g/e[_+y]):g>0&&(o=-R*q*Math.log(1+g)/g):I.outboundAttractionDistribution?(g=1,o=-R*q/e[_+y]):(g=1,o=-R*q)),g>0&&(e[_+v]+=E*o,e[_+c]+=k*o,e[A+v]-=E*o,e[A+c]-=k*o);var ve,he,oe,M,ge,pe;if(le===!0)for(r=0;r<Z;r+=H)e[r+$]!==1&&(ve=Math.sqrt(Math.pow(e[r+v],2)+Math.pow(e[r+c],2)),ve>we&&(e[r+v]=e[r+v]*we/ve,e[r+c]=e[r+c]*we/ve),he=e[r+y]*Math.sqrt((e[r+w]-e[r+v])*(e[r+w]-e[r+v])+(e[r+D]-e[r+c])*(e[r+D]-e[r+c])),oe=Math.sqrt((e[r+w]+e[r+v])*(e[r+w]+e[r+v])+(e[r+D]+e[r+c])*(e[r+D]+e[r+c]))/2,M=.1*Math.log(1+oe)/(1+Math.sqrt(he)),ge=e[r+i]+e[r+v]*(M/I.slowDown),e[r+i]=ge,pe=e[r+f]+e[r+c]*(M/I.slowDown),e[r+f]=pe);else for(r=0;r<Z;r+=H)e[r+$]!==1&&(he=e[r+y]*Math.sqrt((e[r+w]-e[r+v])*(e[r+w]-e[r+v])+(e[r+D]-e[r+c])*(e[r+D]-e[r+c])),oe=Math.sqrt((e[r+w]+e[r+v])*(e[r+w]+e[r+v])+(e[r+D]+e[r+c])*(e[r+D]+e[r+c]))/2,M=e[r+P]*Math.log(1+oe)/(1+Math.sqrt(he)),e[r+P]=Math.min(1,Math.sqrt(M*(Math.pow(e[r+v],2)+Math.pow(e[r+c],2))/(1+Math.sqrt(he)))),ge=e[r+i]+e[r+v]*(M/I.slowDown),e[r+i]=ge,pe=e[r+f]+e[r+c]*(M/I.slowDown),e[r+f]=pe);return{}}})();var a=h.exports;self.addEventListener("message",function(i){var f=i.data;l=new Float32Array(f.nodes),f.edges&&(s=new Float32Array(f.edges)),a(f.settings,l,s),self.postMessage({nodes:l.buffer},[l.buffer])})},qe=Ze,Je=Ge,Ke=je.createEdgeWeightGetter,te=$e,Qe=Ve;function Q(t,l){if(l=l||{},!Je(t))throw new Error("graphology-layout-forceatlas2/worker: the given graph is not a valid graphology instance.");var s=Ke("getEdgeWeight"in l?l.getEdgeWeight:"weight").fromEntry,h=te.assign({},Qe,l.settings),a=te.validateSettings(h);if(a)throw new Error("graphology-layout-forceatlas2/worker: "+a.message);this.worker=null,this.graph=t,this.settings=h,this.getEdgeWeight=s,this.matrices=null,this.running=!1,this.killed=!1,this.outputReducer=typeof l.outputReducer=="function"?l.outputReducer:null,this.handleMessage=this.handleMessage.bind(this);var i=void 0,f=this;this.handleGraphUpdate=function(){f.worker&&f.worker.terminate(),i&&clearTimeout(i),i=setTimeout(function(){i=void 0,f.spawnWorker()},0)},t.on("nodeAdded",this.handleGraphUpdate),t.on("edgeAdded",this.handleGraphUpdate),t.on("nodeDropped",this.handleGraphUpdate),t.on("edgeDropped",this.handleGraphUpdate),this.spawnWorker()}Q.prototype.isRunning=function(){return this.running};Q.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=te.createWorker(qe),this.worker.addEventListener("message",this.handleMessage),this.running&&(this.running=!1,this.start())};Q.prototype.handleMessage=function(t){if(this.running){var l=new Float32Array(t.data.nodes);te.assignLayoutChanges(this.graph,l,this.outputReducer),this.outputReducer&&te.readGraphPositions(this.graph,l),this.matrices.nodes=l,this.askForIterations()}};Q.prototype.askForIterations=function(t){var l=this.matrices,s={settings:this.settings,nodes:l.nodes.buffer},h=[l.nodes.buffer];return t&&(s.edges=l.edges.buffer,h.push(l.edges.buffer)),this.worker.postMessage(s,h),this};Q.prototype.start=function(){if(this.killed)throw new Error("graphology-layout-forceatlas2/worker.start: layout was killed.");return this.running?this:(this.matrices=te.graphToByteArrays(this.graph,this.getEdgeWeight),this.running=!0,this.askForIterations(!0),this)};Q.prototype.stop=function(){return this.running=!1,this};Q.prototype.kill=function(){if(this.killed)return this;this.running=!1,this.killed=!0,this.matrices=null,this.worker.terminate(),this.graph.removeListener("nodeAdded",this.handleGraphUpdate),this.graph.removeListener("edgeAdded",this.handleGraphUpdate),this.graph.removeListener("nodeDropped",this.handleGraphUpdate),this.graph.removeListener("edgeDropped",this.handleGraphUpdate)};var Xe=Q;const gr=Re(Xe);function Ae(t){return function(l,s){return l+Math.floor(t()*(s-l+1))}}var Oe=Ae(Math.random);Oe.createRandom=Ae;var Ye=Oe,Be=Ye.createRandom;function Se(t){var l=Be(t);return function(s){for(var h=s.length,a=h-1,i=-1;++i<h;){var f=l(i,a),v=s[f];s[f]=s[i],s[i]=v}}}var de=Se(Math.random);de.createShuffleInPlace=Se;var xe=de,Me=ze,Ne=Ge,er=xe,rr={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function j(t,l,s,h,a){this.wrappedCircle=a||null,this.children={},this.countChildren=0,this.id=t||null,this.next=null,this.previous=null,this.x=l||null,this.y=s||null,a?this.r=1010101:this.r=h||999}j.prototype.hasChildren=function(){return this.countChildren>0};j.prototype.addChild=function(t,l){this.children[t]=l,++this.countChildren};j.prototype.getChild=function(t){if(!this.children.hasOwnProperty(t)){var l=new j;this.children[t]=l,++this.countChildren}return this.children[t]};j.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var t=this;for(var l in t.children){var s=t.children[l];s.x+=t.x,s.y+=t.y,s.applyPositionToChildren()}}};function me(t,l,s){for(var h in l.children){var a=l.children[h];a.hasChildren()?me(t,a,s):s[a.id]={x:a.x,y:a.y}}}function ye(t,l){var s=t.r-l.r,h=l.x-t.x,a=l.y-t.y;return s<0||s*s<h*h+a*a}function Te(t,l){var s=t.r-l.r+1e-6,h=l.x-t.x,a=l.y-t.y;return s>0&&s*s>h*h+a*a}function Ce(t,l){for(var s=0;s<l.length;++s)if(!Te(t,l[s]))return!1;return!0}function nr(t){return new j(null,t.x,t.y,t.r)}function ie(t,l){var s=t.x,h=t.y,a=t.r,i=l.x,f=l.y,v=l.r,c=i-s,w=f-h,D=v-a,y=Math.sqrt(c*c+w*w);return new j(null,(s+i+c/y*D)/2,(h+f+w/y*D)/2,(y+a+v)/2)}function Le(t,l,s){var h=t.x,a=t.y,i=t.r,f=l.x,v=l.y,c=l.r,w=s.x,D=s.y,y=s.r,P=h-f,F=h-w,$=a-v,V=a-D,X=c-i,J=y-i,b=h*h+a*a-i*i,S=b-f*f-v*v+c*c,G=b-w*w-D*D+y*y,W=F*$-P*V,m=($*G-V*S)/(W*2)-h,C=(V*X-$*J)/W,O=(F*S-P*G)/(W*2)-a,T=(P*J-F*X)/W,U=C*C+T*T-1,Y=2*(i+m*C+O*T),H=m*m+O*O-i*i,se=-(U?(Y+Math.sqrt(Y*Y-4*U*H))/(2*U):H/Y);return new j(null,h+m+C*se,a+O+T*se,se)}function tr(t){switch(t.length){case 1:return nr(t[0]);case 2:return ie(t[0],t[1]);case 3:return Le(t[0],t[1],t[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+t.length)}}function sr(t,l){var s,h;if(Ce(l,t))return[l];for(s=0;s<t.length;++s)if(ye(l,t[s])&&Ce(ie(t[s],l),t))return[t[s],l];for(s=0;s<t.length-1;++s)for(h=s+1;h<t.length;++h)if(ye(ie(t[s],t[h]),l)&&ye(ie(t[s],l),t[h])&&ye(ie(t[h],l),t[s])&&Ce(Le(t[s],t[h],l),t))return[t[s],t[h],l];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function _e(t){var l=t.wrappedCircle,s=t.next.wrappedCircle,h=l.r+s.r,a=(l.x*s.r+s.x*l.r)/h,i=(l.y*s.r+s.y*l.r)/h;return a*a+i*i}function lr(t,l){var s=0,h=t.slice(),a=t.length,i=[],f,v;for(l(h);s<a;)f=h[s],v&&Te(v,f)?++s:(i=sr(i,f),v=tr(i),s=0);return v}function Ie(t,l,s){var h=t.x-l.x,a,i,f=t.y-l.y,v,c,w=h*h+f*f;w?(i=l.r+s.r,i*=i,c=t.r+s.r,c*=c,i>c?(a=(w+c-i)/(2*w),v=Math.sqrt(Math.max(0,c/w-a*a)),s.x=t.x-a*h-v*f,s.y=t.y-a*f+v*h):(a=(w+i-c)/(2*w),v=Math.sqrt(Math.max(0,i/w-a*a)),s.x=l.x+a*h-v*f,s.y=l.y+a*f+v*h)):(s.x=l.x+s.r,s.y=l.y)}function be(t,l){var s=t.r+l.r-1e-6,h=l.x-t.x,a=l.y-t.y;return s>0&&s*s>h*h+a*a}function hr(t,l){var s=t.length;if(s===0)return 0;var h,a,i,f,v,c,w,D,y,P;if(h=t[0],h.x=0,h.y=0,s<=1)return h.r;if(a=t[1],h.x=-a.r,a.x=h.r,a.y=0,s<=2)return h.r+a.r;i=t[2],Ie(a,h,i),h=new j(null,null,null,null,h),a=new j(null,null,null,null,a),i=new j(null,null,null,null,i),h.next=i.previous=a,a.next=h.previous=i,i.next=a.previous=h;e:for(c=3;c<s;++c){i=t[c],Ie(h.wrappedCircle,a.wrappedCircle,i),i=new j(null,null,null,null,i),w=a.next,D=h.previous,y=a.wrappedCircle.r,P=h.wrappedCircle.r;do if(y<=P){if(be(w.wrappedCircle,i.wrappedCircle)){a=w,h.next=a,a.previous=h,--c;continue e}y+=w.wrappedCircle.r,w=w.next}else{if(be(D.wrappedCircle,i.wrappedCircle)){h=D,h.next=a,a.previous=h,--c;continue e}P+=D.wrappedCircle.r,D=D.previous}while(w!==D.next);for(i.previous=h,i.next=a,h.next=a.previous=a=i,f=_e(h);(i=i.next)!==a;)(v=_e(i))<f&&(h=i,f=v);a=h.next}h=[a.wrappedCircle],i=a;for(var F=1e4;(i=i.next)!==a&&--F!==0;)h.push(i.wrappedCircle);for(i=lr(h,l),c=0;c<s;++c)h=t[c],h.x-=i.x,h.y-=i.y;return i.r}function Pe(t,l){var s=0;if(t.hasChildren()){for(var h in t.children){var a=t.children[h];a.hasChildren()&&(a.r=Pe(a,l))}s=hr(Object.values(t.children),l)}return s}function ir(t,l){Pe(t,l);for(var s in t.children){var h=t.children[s];h.applyPositionToChildren()}}function Fe(t,l,s){if(!Ne(l))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");s=Me(s,rr);var h={},a={},i=l.nodes(),f=s.center,v=s.hierarchyAttributes,c=er.createShuffleInPlace(s.rng),w=s.scale,D=new j;l.forEachNode(function(X,J){var b=J.size?J.size:1,S=new j(X,null,null,b),G=D;v.forEach(function(W){var m=J[W];G=G.getChild(m)}),G.addChild(X,S)}),ir(D,c),me(l,D,h);var y=i.length,P,F,$;for($=0;$<y;$++){var V=i[$];P=f+w*h[V].x,F=f+w*h[V].y,a[V]={x:P,y:F},t&&(l.setNodeAttribute(V,s.attributes.x,P),l.setNodeAttribute(V,s.attributes.y,F))}return a}var We=Fe.bind(null,!1);We.assign=Fe.bind(null,!0);var ar=We;const pr=Re(ar);export{gr as F,pr as c};
