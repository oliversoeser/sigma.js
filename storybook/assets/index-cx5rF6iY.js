import{g as ye}from"./_commonjsHelpers-BosuxZz1.js";import{i as Ee}from"./utils-8yT8BWPw.js";import{g as we}from"./defaults-9mJNxk8k.js";var R=0,D=1,v=2,g=3,k=4,P=5,b=6,ve=7,re=8,ge=9,De=0,Oe=1,Re=2,I=0,m=1,T=2,q=3,F=4,O=5,L=6,H=7,C=8,ce=3,z=10,_e=3,G=9,he=10,Se=function(f,e,y){var E,u,n,o,h,_,W,S,r,X,p=e.length,x=y.length,U=f.adjustSizes,Y=f.barnesHutTheta*f.barnesHutTheta,ee,w,c,i,j,a,l,s=[];for(n=0;n<p;n+=z)e[n+k]=e[n+v],e[n+P]=e[n+g],e[n+v]=0,e[n+g]=0;if(f.outboundAttractionDistribution){for(ee=0,n=0;n<p;n+=z)ee+=e[n+b];ee/=p/z}if(f.barnesHutOptimize){var $=1/0,J=-1/0,V=1/0,K=-1/0,A,Q,ae;for(n=0;n<p;n+=z)$=Math.min($,e[n+R]),J=Math.max(J,e[n+R]),V=Math.min(V,e[n+D]),K=Math.max(K,e[n+D]);var ne=J-$,se=K-V;for(ne>se?(V-=(ne-se)/2,K=V+ne):($-=(se-ne)/2,J=$+se),s[0+I]=-1,s[0+m]=($+J)/2,s[0+T]=(V+K)/2,s[0+q]=Math.max(J-$,K-V),s[0+F]=-1,s[0+O]=-1,s[0+L]=0,s[0+H]=0,s[0+C]=0,E=1,n=0;n<p;n+=z)for(u=0,ae=ce;;)if(s[u+O]>=0){e[n+R]<s[u+m]?e[n+D]<s[u+T]?A=s[u+O]:A=s[u+O]+G:e[n+D]<s[u+T]?A=s[u+O]+G*2:A=s[u+O]+G*3,s[u+H]=(s[u+H]*s[u+L]+e[n+R]*e[n+b])/(s[u+L]+e[n+b]),s[u+C]=(s[u+C]*s[u+L]+e[n+D]*e[n+b])/(s[u+L]+e[n+b]),s[u+L]+=e[n+b],u=A;continue}else if(s[u+I]<0){s[u+I]=n;break}else{if(s[u+O]=E*G,S=s[u+q]/2,r=s[u+O],s[r+I]=-1,s[r+m]=s[u+m]-S,s[r+T]=s[u+T]-S,s[r+q]=S,s[r+F]=r+G,s[r+O]=-1,s[r+L]=0,s[r+H]=0,s[r+C]=0,r+=G,s[r+I]=-1,s[r+m]=s[u+m]-S,s[r+T]=s[u+T]+S,s[r+q]=S,s[r+F]=r+G,s[r+O]=-1,s[r+L]=0,s[r+H]=0,s[r+C]=0,r+=G,s[r+I]=-1,s[r+m]=s[u+m]+S,s[r+T]=s[u+T]-S,s[r+q]=S,s[r+F]=r+G,s[r+O]=-1,s[r+L]=0,s[r+H]=0,s[r+C]=0,r+=G,s[r+I]=-1,s[r+m]=s[u+m]+S,s[r+T]=s[u+T]+S,s[r+q]=S,s[r+F]=s[u+F],s[r+O]=-1,s[r+L]=0,s[r+H]=0,s[r+C]=0,E+=4,e[s[u+I]+R]<s[u+m]?e[s[u+I]+D]<s[u+T]?A=s[u+O]:A=s[u+O]+G:e[s[u+I]+D]<s[u+T]?A=s[u+O]+G*2:A=s[u+O]+G*3,s[u+L]=e[s[u+I]+b],s[u+H]=e[s[u+I]+R],s[u+C]=e[s[u+I]+D],s[A+I]=s[u+I],s[u+I]=-1,e[n+R]<s[u+m]?e[n+D]<s[u+T]?Q=s[u+O]:Q=s[u+O]+G:e[n+D]<s[u+T]?Q=s[u+O]+G*2:Q=s[u+O]+G*3,A===Q)if(ae--){u=A;continue}else{ae=ce;break}s[Q+I]=n;break}}if(f.barnesHutOptimize)for(w=f.scalingRatio,n=0;n<p;n+=z)for(u=0;;)if(s[u+O]>=0)if(a=Math.pow(e[n+R]-s[u+H],2)+Math.pow(e[n+D]-s[u+C],2),X=s[u+q],4*X*X/a<Y){if(c=e[n+R]-s[u+H],i=e[n+D]-s[u+C],U===!0?a>0?(l=w*e[n+b]*s[u+L]/a,e[n+v]+=c*l,e[n+g]+=i*l):a<0&&(l=-w*e[n+b]*s[u+L]/Math.sqrt(a),e[n+v]+=c*l,e[n+g]+=i*l):a>0&&(l=w*e[n+b]*s[u+L]/a,e[n+v]+=c*l,e[n+g]+=i*l),u=s[u+F],u<0)break;continue}else{u=s[u+O];continue}else{if(_=s[u+I],_>=0&&_!==n&&(c=e[n+R]-e[_+R],i=e[n+D]-e[_+D],a=c*c+i*i,U===!0?a>0?(l=w*e[n+b]*e[_+b]/a,e[n+v]+=c*l,e[n+g]+=i*l):a<0&&(l=-w*e[n+b]*e[_+b]/Math.sqrt(a),e[n+v]+=c*l,e[n+g]+=i*l):a>0&&(l=w*e[n+b]*e[_+b]/a,e[n+v]+=c*l,e[n+g]+=i*l)),u=s[u+F],u<0)break;continue}else for(w=f.scalingRatio,o=0;o<p;o+=z)for(h=0;h<o;h+=z)c=e[o+R]-e[h+R],i=e[o+D]-e[h+D],U===!0?(a=Math.sqrt(c*c+i*i)-e[o+re]-e[h+re],a>0?(l=w*e[o+b]*e[h+b]/a/a,e[o+v]+=c*l,e[o+g]+=i*l,e[h+v]-=c*l,e[h+g]-=i*l):a<0&&(l=100*w*e[o+b]*e[h+b],e[o+v]+=c*l,e[o+g]+=i*l,e[h+v]-=c*l,e[h+g]-=i*l)):(a=Math.sqrt(c*c+i*i),a>0&&(l=w*e[o+b]*e[h+b]/a/a,e[o+v]+=c*l,e[o+g]+=i*l,e[h+v]-=c*l,e[h+g]-=i*l));for(r=f.gravity/f.scalingRatio,w=f.scalingRatio,n=0;n<p;n+=z)l=0,c=e[n+R],i=e[n+D],a=Math.sqrt(Math.pow(c,2)+Math.pow(i,2)),f.strongGravityMode?a>0&&(l=w*e[n+b]*r):a>0&&(l=w*e[n+b]*r/a),e[n+v]-=c*l,e[n+g]-=i*l;for(w=1*(f.outboundAttractionDistribution?ee:1),W=0;W<x;W+=_e)o=y[W+De],h=y[W+Oe],S=y[W+Re],j=Math.pow(S,f.edgeWeightInfluence),c=e[o+R]-e[h+R],i=e[o+D]-e[h+D],U===!0?(a=Math.sqrt(c*c+i*i)-e[o+re]-e[h+re],f.linLogMode?f.outboundAttractionDistribution?a>0&&(l=-w*j*Math.log(1+a)/a/e[o+b]):a>0&&(l=-w*j*Math.log(1+a)/a):f.outboundAttractionDistribution?a>0&&(l=-w*j/e[o+b]):a>0&&(l=-w*j)):(a=Math.sqrt(Math.pow(c,2)+Math.pow(i,2)),f.linLogMode?f.outboundAttractionDistribution?a>0&&(l=-w*j*Math.log(1+a)/a/e[o+b]):a>0&&(l=-w*j*Math.log(1+a)/a):f.outboundAttractionDistribution?(a=1,l=-w*j/e[o+b]):(a=1,l=-w*j)),a>0&&(e[o+v]+=c*l,e[o+g]+=i*l,e[h+v]-=c*l,e[h+g]-=i*l);var ue,d,fe,Z,le,te;if(U===!0)for(n=0;n<p;n+=z)e[n+ge]!==1&&(ue=Math.sqrt(Math.pow(e[n+v],2)+Math.pow(e[n+g],2)),ue>he&&(e[n+v]=e[n+v]*he/ue,e[n+g]=e[n+g]*he/ue),d=e[n+b]*Math.sqrt((e[n+k]-e[n+v])*(e[n+k]-e[n+v])+(e[n+P]-e[n+g])*(e[n+P]-e[n+g])),fe=Math.sqrt((e[n+k]+e[n+v])*(e[n+k]+e[n+v])+(e[n+P]+e[n+g])*(e[n+P]+e[n+g]))/2,Z=.1*Math.log(1+fe)/(1+Math.sqrt(d)),le=e[n+R]+e[n+v]*(Z/f.slowDown),e[n+R]=le,te=e[n+D]+e[n+g]*(Z/f.slowDown),e[n+D]=te);else for(n=0;n<p;n+=z)e[n+ge]!==1&&(d=e[n+b]*Math.sqrt((e[n+k]-e[n+v])*(e[n+k]-e[n+v])+(e[n+P]-e[n+g])*(e[n+P]-e[n+g])),fe=Math.sqrt((e[n+k]+e[n+v])*(e[n+k]+e[n+v])+(e[n+P]+e[n+g])*(e[n+P]+e[n+g]))/2,Z=e[n+ve]*Math.log(1+fe)/(1+Math.sqrt(d)),e[n+ve]=Math.min(1,Math.sqrt(Z*(Math.pow(e[n+v],2)+Math.pow(e[n+g],2))/(1+Math.sqrt(d)))),le=e[n+R]+e[n+v]*(Z/f.slowDown),e[n+R]=le,te=e[n+D]+e[n+g]*(Z/f.slowDown),e[n+D]=te);return{}},B={},N=10,ie=3;B.assign=function(t){t=t||{};var f=Array.prototype.slice.call(arguments).slice(1),e,y,E;for(e=0,E=f.length;e<E;e++)if(f[e])for(y in f[e])t[y]=f[e][y];return t};B.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};B.graphToByteArrays=function(t,f){var e=t.order,y=t.size,E={},u,n=new Float32Array(e*N),o=new Float32Array(y*ie);return u=0,t.forEachNode(function(h,_){E[h]=u,n[u]=_.x,n[u+1]=_.y,n[u+2]=0,n[u+3]=0,n[u+4]=0,n[u+5]=0,n[u+6]=1,n[u+7]=1,n[u+8]=_.size||1,n[u+9]=_.fixed?1:0,u+=N}),u=0,t.forEachEdge(function(h,_,W,S,r,X,p){var x=E[W],U=E[S],Y=f(h,_,W,S,r,X,p);n[x+6]+=Y,n[U+6]+=Y,o[u]=x,o[u+1]=U,o[u+2]=Y,u+=ie}),{nodes:n,edges:o}};B.assignLayoutChanges=function(t,f,e){var y=0;t.updateEachNodeAttributes(function(E,u){return u.x=f[y],u.y=f[y+1],y+=N,e?e(E,u):u})};B.readGraphPositions=function(t,f){var e=0;t.forEachNode(function(y,E){f[e]=E.x,f[e+1]=E.y,e+=N})};B.collectLayoutChanges=function(t,f,e){for(var y=t.nodes(),E={},u=0,n=0,o=f.length;u<o;u+=N){if(e){var h=Object.assign({},t.getNodeAttributes(y[n]));h.x=f[u],h.y=f[u+1],h=e(y[n],h),E[y[n]]={x:h.x,y:h.y}}else E[y[n]]={x:f[u],y:f[u+1]};n++}return E};B.createWorker=function(f){var e=window.URL||window.webkitURL,y=f.toString(),E=e.createObjectURL(new Blob(["("+y+").call(this);"],{type:"text/javascript"})),u=new Worker(E);return e.revokeObjectURL(E),u};var Ie={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},Ge=Ee,Te=we.createEdgeWeightGetter,Le=Se,M=B,pe=Ie;function be(t,f,e){if(!Ge(f))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof e=="number"&&(e={iterations:e});var y=e.iterations;if(typeof y!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(y<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var E=Te("getEdgeWeight"in e?e.getEdgeWeight:"weight").fromEntry,u=typeof e.outputReducer=="function"?e.outputReducer:null,n=M.assign({},pe,e.settings),o=M.validateSettings(n);if(o)throw new Error("graphology-layout-forceatlas2: "+o.message);var h=M.graphToByteArrays(f,E),_;for(_=0;_<y;_++)Le(n,h.nodes,h.edges);if(t){M.assignLayoutChanges(f,h.nodes,u);return}return M.collectLayoutChanges(f,h.nodes)}function Ae(t){var f=typeof t=="number"?t:t.order;return{barnesHutOptimize:f>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(f)}}var oe=be.bind(null,!1);oe.assign=be.bind(null,!0);oe.inferSettings=Ae;var me=oe;const We=ye(me);export{Ie as d,We as f,B as h};
